enchant();

 report_counter = 0;
 oldtest_counter = 0;
 credit_counter = 0;
 hp = 100;
 maxhp = 100;
 attack = 3;
 resist = 0;
 level = 1;
 enemyid = 0;
 boss_counter = 0; //敵を倒すごとにカウンターが増えていく。3でラスボス出現
 enemypopscene = 0;
 backgroundmusic = new Bgm();

window.onload = function() {
 var game = new Core(320, 320);
 game.preload('./img/chara2.png', './img/labolatory.jpg', './img/message.png','./img/schoolB.png','./img/ST-Schl-I01.png','./img/Item.png',
'sound/button03b.mp3','./img/student.png','./img/ganchan.png', './img/stockvault-swirl-background111520.jpg','BGM/streetofrage.mp3');
 game.fps = 30;
 game.onload = function() {

   game.scale = 2;
   var ACCEL = 8.0;
   var PC_MARGIN_HORIZONTAL = 10;
   var PC_MARGIN_TOP = 18;
   var VMAX_KEY = 6;


   //core.pushScene(scene);
   game.bs = 48; //ブロックサイズ



   var basemap = new Sprite(1600, 1600);
   basemap.image = game.assets['./img/stockvault-swirl-background111520.jpg'];
   basemap.x = 0;
   basemap.y = 0;

   var map = new Map(32, 32);
   map.image = game.assets['./img/ST-Schl-I01.png'];
    var baseMap1 = [
   [25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25],
   [25, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,10,10,10,10,10,10,10,10,10,10,10,25],
   [25, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,25,80,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,80,25,10,10,10,10,10,10,10,10,10,10,10,25],
   [25, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,25, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,25,10,10,10,10,10,10,10,10,10,10,10,25],
   [25, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,25, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,25,10,10,10,10,10,10,10,10,10,10,10,25],
   [25, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,25, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,25,10,10,10,10,10,10,10,10,10,10,10,25],
   [25, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,25, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,25,10,10,10,10,10,10,10,10,10,10,10,25],
   [25, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,25, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,25,10,10,10,10,10,10,10,10,10,10,10,25],
   [25, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,25, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,25,10,10,10,10,10,10,10,10,10,10,10,25],
   [25, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,25, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,25,10,10,10,10,10,10,10,10,10,10,10,25],
   [25, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,25, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,25,10,10,10,10,10,10,10,10,10,10,10,25],
   [25, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,25, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,25,10,10,10,10,10,10,10,10,10,10,10,25],
   [25, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25, 0, 0,25,25,25,10,10,10,10,10,10,10,10,10,10,10,25],
   [25, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25, 0, 0,25,25,25,10,10,10,10,10,10,10,10,10,10,10,25],
   [25, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25, 0, 0,25,25,25,25,25,25,10,10,10,10,10,10,10,10,25],
   [25, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,25,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,10,10,10,10,10,10,10,10,10,25],
   [25, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,25,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,10,10,10,10,10,10,10,10,10,25],
   [25, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,10,10,10,10,10,10,10,10,10,25],
   [25, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,25,10,10,10,10,10,10,10,10,25],
   [25, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,25,10,10,10,10,10,10,10,10,25],
   [25, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,25,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,25,10,10,10,10,10,10,10,10,25],
   [25,25,25,25,25,25,25,25,25,25,25,25,25,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,25,10,10,10,10,10,10,10,10,25],
   [25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,11,11,11,25,25,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,25,25,25,25,25,25,25,25,25,25],
   [25,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,25,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,25, 8, 8, 8, 8, 8, 8, 8, 8, 8],
   [25,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,25,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,25, 8, 8, 8, 8, 8, 8, 8, 8, 8],
   [25,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,25,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,25, 8, 8, 8, 8, 8, 8, 8, 8, 8],
   [25,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,25,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,25, 8, 8, 8, 8, 8, 8, 8, 8, 8],
   [25,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,25,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,25, 8, 8, 8, 8, 8, 8, 8, 8, 8],
   [25,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,25,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,25, 8, 8, 8, 8, 8, 8, 8, 8, 8],
   [25,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,25,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,25, 8, 8, 8, 8, 8, 8, 8, 8, 8],
   [25,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,25,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,25, 8, 8, 8, 8, 8, 8, 8, 8, 8],
   [25,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,25,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,25, 8, 8, 8, 8, 8, 8, 8, 8, 8],
   [25,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,25,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,25, 8, 8, 8, 8, 8, 8, 8, 8, 8],
   [25,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,25,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,25, 8, 8, 8, 8, 8, 8, 8, 8, 8],
   [25,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,25,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,25, 8, 8, 8, 8, 8, 8, 8, 8, 8],
   [25,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,25,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,25, 8, 8, 8, 8, 8, 8, 8, 8, 8],
   [25,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,25,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,25, 8, 8, 8, 8, 8, 8, 8, 8, 8],
   [25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,25, 8, 8, 8, 8, 8, 8, 8, 8, 8],
   [ 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8],
   [ 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8],
   [ 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8],
   [ 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8],
   [ 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8],
   [ 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8],
   [ 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8],
   [ 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8],
   [ 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8],
   [ 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8],
   [ 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8],
   [ 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8]
   ];
   baseMap1.backgroundColor = 'rgba(0, 0, 0, 1)';

   var map2 = new Map(32, 32);
   map2.image = game.assets['./img/ST-Schl-I01.png'];
   var baseMap2 = [
     [ 25,141,142, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 66, 67, 66, 67, 66, 67, 66, 67, 66, 67, 66, 67, 66, 67, 66, 67, 66, 67, 66, 67, 66, 67, 66, 67, 25,337,338,339,340,337,338,339,340, 25, 25, 25, 25],
     [ 25,200,201,201,201,201,201,201,201,201,201,202, 25, 74, 75, 74, 75, 74, 75, 74, 75, 74, 75, 74, 75, 74, 75, 74, 75, 74, 75, 74, 75, 74, 75, 74, 75, 25,345,346,347,348,345,346,347,348, 10, 10, 10, 25],
     [ 25,208,209,209,209,209,209,209,209,209,209,210, 25, 81,362,362, 81, 81, 81, 81, 81, 81, 81, 81, 81, 81, 81, 81, 81, 81, 81, 81, 81, 81, 81, 81, 80, 25,353,354,355,356,353,354,355,356, 10, 10, 10, 25],
     [ 25,  6,  6,  6,  6,  6,  6,  6,  6,  6,222,222, 25,177,370,370,  0,  0,  0,  0,294,  0,  0,294,  0,  0,294,  0,  0,294,  0,  0,  0,  0,  0,  0,  0, 25, 10, 10, 10,294, 10, 10,294, 10, 10, 10, 10, 25],
     [ 25,  6,  6,  6,  6,  6,  6,  6,  6,  6,230,230, 25,185,  0,  0,  0,  0,312,313,314,315,316,317,318,316,317,318,316,317,318,319,  0,  0,  0,  0,  0, 25, 10, 10,316,317,318,316,317,318, 10, 10, 10, 25],
     [ 25,  6,246,  6,246,  6,246,  6,246,  6,246,  6, 25,177,  0,  0,  0,  0,320,321,322,323,324,325,326,324,325,326,324,325,326,327,  0,  0,  0,  0,  0, 25, 10, 10,324,325,326,324,325,326, 10, 10, 10, 25],
     [ 25,  6,254,  6,254,  6,254,  6,254,  6,254,  6, 25,185,  0,  0,  0,  0,328,329,330,331,332,333,334,332,333,334,332,333,334,335,  0,  0,  0,  0,  0, 25, 10, 10,332,333,334,332,333,334, 10, 10, 10, 25],
     [ 25,  6,262,  6,262,  6,262,  6,262,  6,262,  6, 25,177,  0,  0,  0,  0,  0,  0,295,  0,  0,295,  0,  0,295,  0,  0,295,  0,  0,  0,  0,  0,  0,  0, 25, 10, 10, 10,295, 10, 10,295, 10, 10, 10, 10, 25],
     [ 25,  6,  6,  6,  6,  6,  6,  6,  6,  6,  6,  6, 25,185,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 25, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 25],
     [ 25,  6,246,  6,246,  6,246,  6,246,  6,246,  6, 25,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 25, 10, 10, 10, 10, 10,316,317,318, 10, 10, 10, 25],
     [ 25,  6,254,  6,254,  6,254,  6,254,  6,254,  6, 25,360,361,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 25, 10, 10, 10, 10, 10,324,325,326, 10, 10, 10, 25],
     [ 25,  6,262,  6,262,  6,262,  6,262,  6,262,  6, 25,368,369,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 25, 10, 10, 10, 10, 10,332,333,334, 10, 10, 10, 25],
     [ 25,  6,  6,  6,  6,  6,  6,  6,  6,  6,  6,  6, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 66, 67, 66, 67, 66, 67, 66, 67, 70,  0, 25, 25, 25,360,361, 10, 10, 10, 10,295, 10, 10, 10, 10, 25],
     [ 25,  6,246,  6,246,  6,246,  6,246,  6,246,  6, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 74, 75, 74, 75, 74, 75, 74, 75, 78,  0, 25, 25, 25,368,369, 10, 10, 10, 10, 10, 10, 10, 10, 10, 25],
     [ 25,  6,254,  6,254,  6,254,  6,254,  6,254,  6, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 86,  0, 25, 25, 25, 25, 25, 25, 10, 10, 10, 10, 10, 10, 10, 10, 25],
     [ 25,  6,262,  6,262,  6,262,  6,262,  6,262,  6, 25, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 10, 10, 10, 10, 10, 10, 10, 10, 10, 25],
     [ 25,  6,  6,  6,  6,  6,  6,  6,  6,  6,  6,  6, 25, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 10, 10, 10, 10, 10, 10, 10, 10, 10, 25],
     [ 25,  6,246,  6,246,  6,246,  6,246,  6,246,  6,  6, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 10, 10, 10, 10,364, 10, 10, 10,363, 25],
     [ 25,  6,254,  6,254,  6,254,  6,254,  6,254,  6,  6, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 25, 10, 10, 10,372, 10,384, 10,371, 25],
     [ 25,  6,262,  6,262,  6,262,  6,262,  6,262,  6,  6, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 25, 10, 10, 10,380, 10,392, 10,379, 25],
     [ 25,  6,  6,  6,  6,  6,  6,  6,  6,  6,  6,  6, 25, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 25, 10, 10, 10, 10, 10, 10, 10, 10, 25],
     [ 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 55, 25, 10, 10, 10, 10, 10, 10, 10, 10, 25],
     [ 25,339,340,339,340,339,340, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 11, 11, 11, 25, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25],
     [ 25,347,348,347,348,347,348, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 25, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 25,  8,  8,  8,  8,  8,  8,  8,  8,  8],
     [ 25,355,356,355,356,355,356, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 25, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 25,  8,  8,  8,  8,  8,  8,  8,  8,  8],
     [ 25, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11,177, 25, 49, 49, 49,137,137, 49,137,137, 49,137,137, 49, 49, 49,137, 25,  8,  8,  8,  8,  8,  8,  8,  8,  8],
     [ 25, 11, 11, 11,294, 11, 11,294, 11, 11,294, 11, 11,294, 11, 11,294, 11, 11, 11, 11, 11, 11,185, 25, 49, 49,  2,145,145,  2,145,145,  2,145,145,  2, 49,  2,145, 25,  8,  8,  8,  8,  8,  8,  8,  8,  8],
     [ 25, 11, 11,313,314,315,316,317,318,313,314,315,316,317,318,313,314,315, 11, 11, 11, 11, 11,177, 25, 49, 49,  2,153,153,  2,153,153,  2,153,153,  2, 49,  2,153, 25,  8,  8,  8,  8,  8,  8,  8,  8,  8],
     [ 25, 11, 11,321,322,323,324,325,326,321,322,323,324,325,326,321,322,323, 11, 11, 11, 11, 11,185, 25, 49, 49,  2,161,161,  2,161,161,  2,161,161,  2, 49,  2,161, 25,  8,  8,  8,  8,  8,  8,  8,  8,  8],
     [ 25, 11, 11,329,330,331,332,333,334,329,330,331,332,333,334,329,330,331, 11, 11, 11, 11, 11,177, 25, 49, 49, 49,169,169, 49,169,169, 49,169,169, 49, 49, 49,169, 25,  8,  8,  8,  8,  8,  8,  8,  8,  8],
     [ 25, 11, 11, 11,295, 11, 11,295, 11, 11,295, 11, 11,295, 11, 11,295, 11, 11, 11, 11, 11, 11,185, 25, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 25,  8,  8,  8,  8,  8,  8,  8,  8,  8],
     [ 25, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 25, 49, 49, 49,137,137, 49,137,137, 49,137,137, 49, 49, 49,137, 25,  8,  8,  8,  8,  8,  8,  8,  8,  8],
     [ 25, 11, 11, 11, 11, 11, 11, 11,289,290,291, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 25,111, 49,  2,145,145,  2,145,145,  2,145,145,  2, 49,  2,145, 25,  8,  8,  8,  8,  8,  8,  8,  8,  8],
     [ 25, 11, 11, 11, 11, 11,386,387,297,298,299,386,387, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 25,119, 49,  2,153,153,  2,153,153,  2,153,153,  2, 49,  2,153, 25,  8,  8,  8,  8,  8,  8,  8,  8,  8],
     [ 25, 11, 11, 11, 11, 11,394,395,305,306,307,394,395, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 25,111, 49,  2,161,161,  2,161,161,  2,161,161,  2, 49,  2,161, 25,  8,  8,  8,  8,  8,  8,  8,  8,  8],
     [ 25, 11, 11, 11, 11, 11, 11, 11, 11,388, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11,360,361, 25,119, 49, 49,169,169, 49,169,169, 49,169,169, 49, 49, 49,169, 25,  8,  8,  8,  8,  8,  8,  8,  8,  8],
     [ 25, 11, 11, 11, 11, 11, 11, 11, 11,396, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11,368,369, 25,118, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 25,  8,  8,  8,  8,  8,  8,  8,  8,  8],
     [ 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 25,  8,  8,  8,  8,  8,  8,  8,  8,  8],
     [  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8],
     [  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8],
     [  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8],
     [  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8],
     [  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8],
     [  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8],
     [  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8],
     [  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8],
     [  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8],
     [  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8],
     [  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8],
     [  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8,  8]
   ];
   baseMap2.backgroundColor = 'rgba(0, 0, 0, 0)';


   var colmap= [
     [ 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
     [ 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1],
     [ 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
     [ 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
     [ 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1],
     [ 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1],
     [ 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
     [ 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
     [ 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
     [ 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 1],
     [ 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 1],
     [ 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
     [ 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
     [ 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
     [ 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1],
     [ 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
     [ 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
     [ 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1],
     [ 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0, 1, 1],
     [ 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0, 1, 1],
     [ 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1],
     [ 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1],
     [ 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
     [ 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0],
     [ 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0],
     [ 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0],
     [ 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0],
     [ 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0],
     [ 1, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0],
     [ 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0],
     [ 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0],
     [ 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0],
     [ 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0],
     [ 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0],
     [ 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 1, 0, 1, 1, 0, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0],
     [ 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0],
     [ 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0],
     [ 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0],
     [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
     [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
     [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
     [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
     [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
     [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
     [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
     [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
     [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
     [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
     [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
     [ 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
     ];

   map.collisionData = colmap;




map.loadData(baseMap1);
map2.loadData(baseMap2);




  var scene = game.rootScene;
  var stage = new Group();

  var here = {x:(16*3) - 8, y:16*2}



  var report = new Sprite(24, 24);
  report.image = game.assets['./img/Item.png'];
  report.x = 300;
  report.y = 500;
  report.frame = 149;

  var report2 = new Sprite(24, 24);
  report2.image = game.assets['./img/Item.png'];
  report2.x = 600;
  report2.y = 200;
  report2.frame = 149;

  var credit2 = new Sprite(32, 32);
  credit2.x = 864;
  credit2.y = 192;

  var report3 = new Sprite(24, 24);
  report3.image = game.assets['./img/Item.png'];
  report3.x = 1472;
  report3.y = 576;
  report3.frame = 149;

var get_report = function(){
  game.addEventListener('bbuttondown', function(){
    if(hero.intersect(report)){
    var item = new Scene(game.bs, game.bs);
    game.pushScene(item);
    item.addChild(Message());
    var text1 = "レポートを手に入れた!!";
    novel(text1, item);
      item.removeChild(Message());
    game.addEventListener('abuttondown', function(){
    report_counter++;
    game.popScene(item);
    stage.removeChild(report);
    game.removeEventListener('abuttondown', arguments.callee);
  });
  game.removeEventListener('bbuttondown', arguments.callee);
}
  });
}

var get_report2 = function(){
  game.addEventListener('bbuttondown', function(){
    if(hero.intersect(report2)){
    var item = new Scene(game.bs, game.bs);
    game.pushScene(item);
    item.addChild(Message());
    var text1 = "レポートを手に入れた!!";
    novel(text1, item);
      item.removeChild(Message());
    game.addEventListener('abuttondown', function(){
    report_counter++;
    game.popScene(item);
    stage.removeChild(report2);
    game.removeEventListener('abuttondown', arguments.callee);
  });
  game.removeEventListener('bbuttondown', arguments.callee);
}
  });
}

var kakomon = Math.round(Math.random()*10);

var get_oldtest = function(){
  game.addEventListener('bbuttondown', function(){
    if(hero.intersect(oldtest)){
      var item2 = new Scene(game.bs, game.bs);
      game.pushScene(item2);
      item2.addChild(Message());
      var text1 = "過去問("+ kakomon +"年分)を手に入れた！！";
      novel(text1, item2);
        item2.removeChild(Message());
        game.addEventListener('abuttondown', function(){
          oldtest_counter = kakomon;
          game.popScene(item2);
          stage.removeChild(oldtest);
      game.removeEventListener('abuttondown', arguments.callee);
    });
    game.removeEventListener('bbuttondown', arguments.callee);
    }
  });
}

var get_credit = function(){
  game.addEventListener('bbuttondown', function(){
    if(hero.intersect(credit)){
      var item3 = new Scene(game.bs, game.bs);
      game.pushScene(item3);
      item3.addChild(Message());
      var text1 = "単位を手に入れてしまった！！@勝った！勝った！夕飯はドン勝だ！！";
      novel(text1, item3);
      item3.removeChild(Message());
      game.addEventListener('abuttondown', function(){
        removeEventListener('abuttondown', arguments.callee);
      });
      game.addEventListener('abuttondown', function(){
        credit_counter++;
        game.popScene(item3);
        stage.removeChild(credit);
        game.removeEventListener('abuttondown', arguments.callee);
      });
      game.removeEventListener('bbuttondown', arguments.callee);
    }
  });
}

var get_credit2 = function(){
  game.addEventListener('bbuttondown', function(){
    if(hero.intersect(credit2)){
      var item4 = new Scene(game.bs, game.bs);
      game.pushScene(item4);
      item4.addChild(Message());
      var text1 = "単位を手に入れてしまった！！@勝った！勝った！夕飯はドン勝だ！！";
      novel(text1, item4);
      item4.removeChild(Message());
      game.addEventListener('abuttondown', function(){
        removeEventListener('abuttondown', arguments.callee);
      });
      game.addEventListener('abuttondown', function(){
        credit_counter++;
        game.popScene(item4);
        stage.removeChild(credit2);
        game.removeEventListener('abuttondown', arguments.callee);
      });
      game.removeEventListener('bbuttondown', arguments.callee);
    }
  });
}

var get_report3 = function(){
  game.addEventListener('bbuttondown', function(){
    if(hero.intersect(report3)){
    var item5 = new Scene(game.bs, game.bs);
    game.pushScene(item5);
    item5.addChild(Message());
    var text1 = "レポートを手に入れた!!";
    novel(text1, item5);
      item5.removeChild(Message());
    game.addEventListener('abuttondown', function(){
    report_counter++;
    game.popScene(item5);
    stage.removeChild(report3);
    game.removeEventListener('abuttondown', arguments.callee);
  });
  game.removeEventListener('bbuttondown', arguments.callee);
}
  });
}
  var oldtest = new Sprite(24, 24);
  oldtest.image = game.assets['./img/Item.png'];
  oldtest.x = 300;
  oldtest.y = 1000;
  oldtest.frame = 141;


  var credit = new Sprite(24, 24); //単位はランダムに生成される強力アイテム、勝ったも同然。
  credit.image = game.assets['./img/Item.png'];
  credit.opacity = 0.2;
  credit.x = Math.random()*1601;
  credit.y = Math.random()*1601;
  credit.frame = 152;



   var hero = new Sprite(32, 48);
   hero.image = game.assets['./img/student.png'];
   hero.x = 1100;
   hero.y = 1150;
   hero.vx = 0;
   hero.vy = 0;
   hero.ax = 0;
   hero.ay = 0;
   hero.frame = 0;

   var nx = here.x;
   var ny = here.y;

   game.keybind(90, 'a');//zキーをaボタンとして登録
   game.keybind(88, 'b');
   game.keybind(27, 'esc');
   game.keybind(71, 'g'); //がんちゃん出現



var enemy = new Sprite(32, 32);
enemy.image = game.assets['./img/chara2.png'];
enemy.x = 100;
enemy.y = 100;
enemy.frame = 4;

var enemy2 = new Sprite(32, 32);
enemy2.image = game.assets['./img/chara2.png'];
enemy2.x = 480;
enemy2.y = 780;
enemy2.frame = 58;

var enemy3 = new Sprite(32, 32);
enemy3.image = game.assets['./img/chara2.png'];
enemy3.x = 500;
enemy3.y = 200;
enemy3.frame = 52;

var ganchan = new Sprite(181, 181);
ganchan.scale = 0.177;
ganchan.image = game.assets['./img/ganchan.png'];
ganchan.x = 1280;
ganchan.y = 128;





var zako = function() {
  game.addEventListener('abuttondown', function(){
    if(hero.intersect(enemy)) {
    var kaiwa = new Scene(game.bs, game.bs);
    game.pushScene(kaiwa);
    kaiwa.addChild(Message());
    var text = "単位が欲しければ私を倒してからよ！！";
    novel(text, kaiwa);
    game.addEventListener('abuttondown', function(){
      enemyid = 1;
      Commandpart();
      stage.removeChild(enemy);
      if(boss_counter == 2){
        stage.addChild(ganchan);
      }
      colmap[3][3] = 0;
      game.removeEventListener('abuttondown', arguments.callee);
    });
    game.removeEventListener('abuttondown', arguments.callee);
  }
  });
}

var zako2 = function()　{
  game.addEventListener('abuttondown', function(){
    if(hero.intersect(enemy2)) {
      var kaiwa2 = new Scene(game.bs, game.bs);
      game.pushScene(kaiwa2);
      kaiwa2.addChild(Message());
      var text = "この世には2種類の人間がいる、単位が取れる人間と取れない人間だ、お前はどっちの人間だ？";
      novel(text, kaiwa2);
      game.addEventListener("abuttondown", function(){
        enemyid = 2;
        Commandpart();
        stage.removeChild(enemy2);
        if(boss_counter == 2){
          stage.addChild(ganchan);
        }
        colmap[23][15] = 0;
        colmap[24][15] = 0;
        game.removeEventListener('abuttondown', arguments.callee);
      });
      game.removeEventListener('abuttondown', arguments.callee);
    }

  });

}

var zako3 = function()　{
  game.addEventListener('abuttondown', function(){
    if(hero.intersect(enemy3)) {
      var kaiwa3 = new Scene(game.bs, game.bs);
      game.pushScene(kaiwa3);
      kaiwa3.addChild(Message());
      var text = "...単位なんて...あげないよ...";
      novel(text, kaiwa3);
      game.addEventListener("abuttondown", function(){
        enemyid = 3;
        Commandpart();
        stage.removeChild(enemy3);
        if(boss_counter == 2){
          stage.addChild(ganchan);
        }
        colmap[5][16] = 0;
        colmap[5][15] = 0;
        colmap[6][16] = 0;
        colmap[6][15] = 0;
        game.removeEventListener('abuttondown', arguments.callee);
      });
      game.removeEventListener('abuttondown', arguments.callee);
    }
  });
}

var last_boss = function() {
  game.addEventListener('abuttondown', function(){
    if(hero.intersect(ganchan) && boss_counter == 3) {
      var kaiwa4 = new Scene(game.bs, game.bs);
      enemyid = 4;
      game.pushScene(kaiwa4);
      kaiwa4.addChild(Message());
      var text_lastboss = "よくここまで来たね。だけど、ここで逃がすわけには行かないんだ。だから君にはここで死んでもらうよ。"
      novel(text_lastboss, kaiwa4);
      game.addEventListener("abuttondown", function(){
        Commandpart();
        stage.removeChild(ganchan);
        game.removeEventListener('abuttondown', arguments.callee);
      });
      game.removeEventListener('abuttondown', arguments.callee);
    }
  });

}



var ganchan_debug = function() {

  game.addEventListener('gbuttondown', function() {
    hp = 1000;
    boss_counter = 3;
  stage.addChild(ganchan);
  ganchan.x = 1100;
  ganchan.y = 1100;

  // console.log("gbuttondown");
  })
}
    get_report();
    get_report2();
    get_oldtest();
    get_credit();
    get_credit2();
    get_report3();


    zako();
    zako2();
    zako3();
    last_boss();
    ganchan_debug(); //本番リリースでは消してね

   hero.addEventListener("enterframe", function(){
     this.ax = 0;
     this.ay = 0;

     this.vx = 0;
     this.vy = 0;

     if(game.input.left) { //左に移動
       this.ax -= ACCEL;
       this.vx -= 5;
       this.frame = this.age % 3 + 12;
     }
     if(game.input.right) { //右に移動
       this.ax += ACCEL;
       this.vx += 5;
       this.frame = this.age % 3 + 24;
     }
     if(game.input.up) { //上に移動
       this.ay -= ACCEL;
       this.vy -= 5;
       this.frame = this.age % 3 + 36;
   }
     if(game.input.down) { //下に移動
       this.ay += ACCEL;
       this.vy += 5;
       this.frame = this.age % 3;
   }






   var hero = this;


     var frictionX = 0; //水平方向摩擦
     var frictionY = 0; //垂直方向摩擦

     /*if(0 < this.friction){
       if(this.friction < this.vx){
         frictionX = -1 * this.friction;
       } else if(0 < this.vx){
         frictionX = -1 * this.vx;
       } else if(this.vx < -1 * this.friction){
         frictionX = this.friction;
       } else if(this.vx < 0) {
         frictionX = -1 * this.vx;
       }
       if(this.friction < this.vy) {
         frictionY = -1 * this.friction;
       } else if (0 < this.vy) {
         frictionY = -1 * this.vy;
       } else if (this.vy < -1 * this.friction) {
         frictionY = this.friction;
       } else if (this.vy < 0){
         frictionY = -1　* this.vy;
       }
     }*/

     //速度
     this.vx += this.ax;
     this.vy += this.ay;
     var vmaxx, vmaxy;
     vmaxx = VMAX_KEY;
     vmaxy = VMAX_KEY;

     this.vx = Math.min(Math.max(this.vx, -1 * vmaxx), vmaxx);
     this.vy = Math.min(Math.max(this.vy, -1 * vmaxy), vmaxy);

     //移動先を判定

     if(this.vx < 0){
       //左方向
       if(!map.hitTest(this.x + this.vx + PC_MARGIN_HORIZONTAL, this.y+PC_MARGIN_TOP)) {
         this.moveTo(this.x + this.vx, this.y);
       } else if(!map.hitTest(this.x + this.vx + PC_MARGIN_HORIZONTAL, this.y + 10 + PC_MARGIN_TOP)) {
         //壁があり、左下方向に余白あり
         this.vy = this.vy ? this.vy : -this.vx;
         this.moveTo(this.x, this.y + this.vy);
         this.vy = 0;
       } else if(!map.hitTest(this.x + this.vx + PC_MARGIN_HORIZONTAL, this.y - 10 + PC_MARGIN_TOP)) {
         //壁があり、左上方向に余白あり
         this.vy = this.vy ? this.vy : this.vx;
         this.moveTo(this.x, this.y + this.vy);
         this.vy = 0;
       }
     } else if(this.vx > 0) {
       //右方向
       if(!map.hitTest(this.x + this.vx + PC_MARGIN_HORIZONTAL, this.y + PC_MARGIN_TOP)) {
         this.moveTo(this.x + this.vx, this.y);
       } else if(!map.hitTest(this.x + this.vx + PC_MARGIN_HORIZONTAL, this.y - 10 + PC_MARGIN_TOP)) {
         //壁があり、右上方向に余白あり
         this.vy = this.vy ? this.vy : -this.vx;
         this.moveTo(this.x, this.y + this.vy);
         this.vy = 0;
       } else if(!map.hitTest(this.x + this.vx + PC_MARGIN_HORIZONTAL, this.y + 10 + PC_MARGIN_TOP)) {
         //壁があり、右下方向に余白あり
         this.vy = this.vy ? this.vy : this.vx;
         this.moveTo(this.x, this.y + this.vy);
         this.vy = 0;
       }
     }

     if(this.vy > 0) {
       //下方向
       if(!map.hitTest(this.x + PC_MARGIN_HORIZONTAL, this.y + this.vy + PC_MARGIN_TOP)) {
         this.moveTo(this.x, this.y + this.vy);
       } else if(!map.hitTest(this.x + 10 + PC_MARGIN_HORIZONTAL, this.y + this.vy + PC_MARGIN_TOP)) {
         //壁があり、右下方向に余白あり
         this.vx = this.vx ? this.vx : -this.vy;
         this.moveTo(this.x + this.vx, this.y);
         this.vx = 0;
       } else if(!map.hitTest(this.x - 10 + PC_MARGIN_HORIZONTAL, this.y + this.vy + PC_MARGIN_TOP)) {
         //壁があり、左下方向に余白あり
         this.vx = this.vx ? this.vx : -this.vy;
         this.moveTo(this.x　+ this.vx, this.y);
         this.vx = 0;
       }
     } else if(this.vy < 0) {
       //上方向
       if(!map.hitTest(this.x + PC_MARGIN_HORIZONTAL, this.y + this.vy + PC_MARGIN_TOP)) {
         this.moveTo(this.x, this.y + this.vy);
       } else if(!map.hitTest(this.x - 10 + PC_MARGIN_HORIZONTAL, this.y + this.vy + PC_MARGIN_TOP)) {
         //壁があり、左上方向に余白あり
         this.vx = this.vx ? this.vx :　+this.vy;
         this.moveTo(this.x + this.vx, this.y);
         this.vx = 0;
       } else if(!map.hitTest(this.x + 10 + PC_MARGIN_HORIZONTAL, this.y + this.vy + PC_MARGIN_TOP)) {
         //壁があり、右上方向に余白あり
         this.vx = this.vx ? this.vx : -this.vy;
         this.moveTo(this.x + this.vx, this.y);
         this.vx = 0;
       }
     }
   });




        // var backgroundmusic = new Bgm();
     backgroundmusic.set(game.assets['BGM/streetofrage.mp3']);
     backgroundmusic.play();
     game.onenterframe = function(){
       backgroundmusic.loop();
     };

     var Status = function(myhp, mylevel, myreport, myoldtest, mycredit){
       var statuscounter = 0;
       game.addEventListener('escbuttondown', function(){
       if(statuscounter == 0){
           statuscounter = 1;
         var status = new Scene();
         game.pushScene(status);
       //status.backgroundColor = '#000000';

       //外枠
       var waku = new Textframestatus(50, 70, 180, 100,0,0,0);
       status.addChild(waku);

       var slabel = new MutableText(60, 63);
       slabel.text = 'STATUS';
       status.addChild(slabel);

       //がくせい
       var gakusei = new Sprite(32, 48);
       gakusei.image = game.assets['./img/student.png'];
       gakusei.x = 170;
       gakusei.y = 75;
       gakusei.frame = [1,1,0,0,2,2];
       status.addChild(gakusei);

       //レベル
       var level = new MutableText(55, 90);
       level.text = 'Lv.' + mylevel;
       status.addChild(level);

       //HP
       var hp = new MutableText(55, 130);
       hp.text = 'HP ' + myhp +'/'+ maxhp;
       status.addChild(hp);

       //ITEM
       var item = new MutableText(55, 180);
       item.text = 'ITEM';
       var itemwaku = new Textframeitemwaku(53, 177, 67, 20,0,0,0);
       status.addChild(itemwaku);
       status.addChild(item);
       item.ontouchend = function(){
         var se = new Bgm();
         se.set(game.assets['sound/button03b.mp3'].clone());
         se.play();
         statuscounter = 2;
         game.pushScene(MyItem(report_counter, oldtest_counter, credit_counter))
       };

       //RETURN
       //var modoru = new MutableText(130, 180);
       //modoru.text = 'RETURN';
       //var modoruwaku = new Textframemodoruwaku(127, 177, 100, 20,0,0,0);
       //status.addChild(modoruwaku);
       //status.addChild(modoru);
       //modoru.ontouchend = function(){    //タッチでゲーム画面にもどる
         //var se = new Bgm();
         //se.set(game.assets['sound/button03b.mp3'].clone());
         //se.play();
         //game.popScene();
       // };
     }else if(statuscounter == 1){
       statuscounter = 0;
       game.popScene();
     }else if(statuscounter == 2){
       statuscounter = 0;
       game.popScene();
       game.popScene();
     }
   });

   };

     //ステータス画面の枠
     var Textframestatus = Class.create(Sprite, {
       initialize:function(x,y,z,u,r,g,b){
         Sprite.call(this, 300, 300);
         this.x = x;
         this.y = y;

         var textframesurface = new Surface(300, 300);
         textframesurface.context.strokeStyle = "rgb(255, 255, 255)"//外枠の色
         textframesurface.context.strokeRect(0, 0, z, u);//枠のみの矩形

         textframesurface.context.fillStyle = "rgb(0, 0, 0)"//塗りつぶしの色
         textframesurface.context.fillRect(1, 1, z-2, u-2);
         this.image = textframesurface;
         game.currentScene.addChild(this);

       }
     });

     var Textframeitemwaku = Class.create(Sprite, {
       initialize:function(x,y,z,u,r,g,b){
         Sprite.call(this, 67, 20);
         this.x = x;
         this.y = y;

         var textframesurface = new Surface(67, 20);
         textframesurface.context.strokeStyle = "rgb(255, 255, 255)"//外枠の色
         textframesurface.context.strokeRect(0, 0, z, u);//枠のみの矩形

         textframesurface.context.fillStyle = "rgb(0, 0, 0)"//塗りつぶしの色
         textframesurface.context.fillRect(1, 1, z-2, u-2);
         this.image = textframesurface;
         game.currentScene.addChild(this);

       }
     });

     var Textframemodoruwaku = Class.create(Sprite, {
       initialize:function(x,y,z,u,r,g,b){
         Sprite.call(this, 100, 20);
         this.x = x;
         this.y = y;

         var textframesurface = new Surface(100, 20);
         textframesurface.context.strokeStyle = "rgb(255, 255, 255)"//外枠の色
         textframesurface.context.strokeRect(0, 0, z, u);//枠のみの矩形

         textframesurface.context.fillStyle = "rgb(0, 0, 0)"//塗りつぶしの色
         textframesurface.context.fillRect(1, 1, z-2, u-2);
         this.image = textframesurface;
         game.currentScene.addChild(this);

       }
     });

     //アイテム一覧画面
       var MyItem = function(myreport, myoldtest, mycredit){
         var myitem = new Scene();
         //myitem.backgroundColor = '#000000';

         //外枠
         var waku = new Textframeitem(40, 90, 230, 110,0,0,0);
         myitem.addChild(waku);

         //ITEMラベル
         var ilabel = new MutableText(55, 85);
         ilabel.text = 'ITEM';
         myitem.addChild(ilabel);

         //レポート
         var report = new MutableText(50, 110);
         report.text = 'REPORT    x' + myreport;
         myitem.addChild(report);

         //過去問
         var oldtest = new MutableText(50, 140);
         oldtest.text = 'OLD TEST  x' + myoldtest;
         myitem.addChild(oldtest);

         //単位
         var credit = new MutableText(50, 170);
         credit.text = 'CREDIT    x' + mycredit;
         myitem.addChild(credit);

         //RETURN
         var modoru = new MutableText(43, 210);
         modoru.text = 'RETURN';
         var modoruwaku = new Textframemodoruwaku(40, 205, 100, 20);
         myitem.addChild(modoruwaku);
         myitem.addChild(modoru);
         modoru.ontouchend = function(){    //タッチでゲーム画面にもどる
           var se = new Bgm();
           se.set(game.assets['sound/button03b.mp3'].clone());
           se.play();
           game.popScene();
         };
         return myitem;
       };

       var Textframeitem = Class.create(Sprite, {
         initialize:function(x,y,z,u,r,g,b){
           Sprite.call(this, 300, 300);
           this.x = x;
           this.y = y;

           var textframesurface = new Surface(300, 300);
           textframesurface.context.strokeStyle = "rgb(255, 255, 255)"//外枠の色
           textframesurface.context.strokeRect(0, 0, z, u);//枠のみの矩形

           textframesurface.context.fillStyle = "rgb(0, 0, 0)"//塗りつぶしの色
           textframesurface.context.fillRect(1, 1, z-2, u-2);
           this.image = textframesurface;
           game.currentScene.addChild(this);

         }
       });

   Status(hp,level,report,oldtest,credit);




   scene.addChild(basemap);
   stage.addChild(map);
   stage.addChild(map2);
   stage.addChild(report);
   stage.addChild(report2);
   stage.addChild(report3);
   stage.addChild(oldtest);
   stage.addChild(credit);
   stage.addChild(credit2);
   stage.addChild(enemy);
   stage.addChild(enemy2);
   stage.addChild(enemy3);
   stage.addChild(hero);
   scene.addChild(stage);
   


this.replaceScene(scene);


scene.addEventListener('enterframe', function(e) {
 var x = Math.min((game.width  - 16) / 2 - hero.x, 0);
 var y = Math.min((game.height - 16) / 2 - hero.y, 0);
 x = Math.max(game.width,  x + map.width)  - map.width;
 y = Math.max(game.height, y + map.height) - map.height;
 stage.x = x;
 stage.y = y;
});


//メッセージ枠の関数
    var Message = function(){
        var message = new Sprite(782,198);
        message.image = game.assets['./img/message.png'];
        message.x = -230;
        message.y = 160;
        message.scale(0.41, 0.5);
        return message;
      };

//文字を１文字ずつ表示する関数
    var novel = function(text,main_scene){
    			var zisuu = text.length;

        	//ラベルを作る
    			var novel_on = new Label();
    			novel_on.x = 25;
    			novel_on.y = 230;
    			novel_on.width = 250;
    			novel_on.height = 160;
    			novel_on.color = '#ffffff';
    			novel_on.font = "17px sans-serif";

    			//一時停止用シーン
    			var pause_scene_at = new Scene();//＠
    			var pause_scene_and = new Scene();//＆
    			var pause_scene_end = new Scene();//＄

    			//フレームに併せて一文字ずつ表示していく
    			var str = 0;
    			novel_on.addEventListener('enterframe',function(){


    				//記号取得用
    				var key = text.substring(str,str+1);
    				//フレームにあわせて一文字ずつ表示していく
    				novel_on.text = text.substring(0,str);

    		 	  //各記号で動作を制御
    				if(key == "@"){//クリック待ち

    					//@を取り除く
    					text = text.replace( "@" , "" );

    					zisuu = text.length;


              }else if(key == "%"){//改行+クリック待ち

              // %を改行に置き換え
    					text = text.replace( "%" , "<br/>" );
                        str += 5;

    					zisuu = text.length;

    					//フレームを止める
    					game.pushScene(pause_scene_at);

    					//クリックでフレーム再開
    					pause_scene_at.addEventListener('touchend',function(){


    						//ポーズシーンを排除・再動作
    						game.popScene(pause_scene_at);
    						game.pushScene(main_scene);


    					});

    				  }else if(key == "&"){//改ページ

    					//&を取り除く
    					text = text.replace( "&" , "" );
    					zisuu = text.length;

    					//フレームを止める
    					game.pushScene(pause_scene_and);

    					//クリックでフレーム再開
    					pause_scene_and.addEventListener('touchend',function(){

    						//ポーズシーンを排除・再動作
    						game.popScene(pause_scene_and);
    						game.pushScene(main_scene);

    						//残っているテキストを抽出
    						text = text.slice(str,zisuu);

    						//フレーム進行をリセット
    						str = 0;

    					});

    				   }else if(key == "$"){//文章終わり

    						//フェードアウト
    						novel_on.tl.delay(20).fadeOut(20).then(function(){

    							//削除
    							main_scene.removeChild(novel_on);
    						});

    				}else{//通常の表示

    					str++;

    				}
    			});

    			//表示
    			main_scene.addChild(novel_on);
    };





};
game.start();
//game.debug();
};
